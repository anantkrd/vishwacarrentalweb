(this["webpackJsonpVishwa Car Rental"]=this["webpackJsonpVishwa Car Rental"]||[]).push([[54],{119:function(e,t,a){"use strict";var r=a(4),n=a(8),o=a(64),i=a.n(o),s=a(1),c=a.n(s),d=a(66),l=["bsPrefix","className","striped","bordered","borderless","hover","size","variant","responsive"],u=c.a.forwardRef((function(e,t){var a=e.bsPrefix,o=e.className,s=e.striped,u=e.bordered,p=e.borderless,h=e.hover,b=e.size,j=e.variant,m=e.responsive,g=Object(n.a)(e,l),f=Object(d.a)(a,"table"),O=i()(o,f,j&&f+"-"+j,b&&f+"-"+b,s&&f+"-striped",u&&f+"-bordered",p&&f+"-borderless",h&&f+"-hover"),y=c.a.createElement("table",Object(r.a)({},g,{className:O,ref:t}));if(m){var v=f+"-responsive";return"string"===typeof m&&(v=v+"-"+m),c.a.createElement("div",{className:v},y)}return y}));t.a=u},425:function(e,t,a){"use strict";a.r(t);var r=a(53),n=a(54),o=a(42),i=a(41),s=a(44),c=a(45),d=a(1),l=a(50),u=a(119),p=a(389),h=a(55),b=a(49),j=(a(57),a(77),a(2)),m=a.n(j),g=a(58),f=a.n(g),O=a(3),y=a(0),v=function(e){Object(s.a)(a,e);var t=Object(c.a)(a);function a(e){var i;return Object(o.a)(this,a),(i=t.call(this,e)).state={userId:"",item:[],error:"",isLoading:!1,loadingColor:"#ffffff",pageNo:0,payment_orderId:"",agentStatus:"",bookingCnfAmount:1},i.loadScript=function(e){return new Promise((function(t){var a=document.createElement("script");a.src=e,a.onload=function(){t(!0)},a.onerror=function(){t(!1)},document.body.appendChild(a)}))},i.prePayment=function(){var e=Object(n.a)(Object(r.a)().mark((function e(t){var a,n,o,s,c,d,l;return Object(r.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i.loadScript("https://checkout.razorpay.com/v1/checkout.js");case 2:if(e.sent){e.next=6;break}return alert("Razorpay SDK failed to load. Are you online?"),e.abrupt("return");case 6:return"amount=",a=t.agentPrice*i.state.bookingCnfAmount/100,console.log("advance:"+a),n=t.finalAmount-t.paid,o={amount:a,bookingId:t.orderId,agentId:i.state.userId,bookingAmount:t.agentPrice,tripAmount:t.finalAmount,userPaid:t.paid,userAmount:n},console.log("dataPay:"+JSON.stringify(o)),s=localStorage.getItem("token"),c={Authorization:"Bearer ".concat(s),"Content-Type":"application/json"},e.next=16,f.a.post("https://vishwacarrental.com:8080/agent/payment",o,{headers:c});case 16:if(d=e.sent){e.next=20;break}return alert("Server error. Are you online?"),e.abrupt("return");case 20:return console.log("result==pay=="+JSON.stringify(d)),i.setState({payment_orderId:d.data.data.id,currency:d.data.data.currency,receipt:d.data.data.receipt}),l=d.data,l.amount,l.id,l.currency,i.payNow(a,d.data.data.id,d.data.data.currency),e.abrupt("return",!1);case 25:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),i}return Object(i.a)(a,[{key:"componentDidMount",value:function(){var e=localStorage.getItem("userId"),t=localStorage.getItem("userType"),a=localStorage.getItem("agentStatus");this.setState({userId:e}),this.setState({agentStatus:a});this.setState({bookingCnfAmount:"5"}),console.log(t+"=="+a),"active"==a&&this.getBooking(e)}},{key:"showPopup",value:function(e){this.prePayment(e)}},{key:"getBooking",value:function(){var e=Object(n.a)(Object(r.a)().mark((function e(t){var a,n,o,i,s,c;return Object(r.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.setState({isLoading:!0}),a=localStorage.getItem("token"),n=this.state.pageNo+1,o={Authorization:"Bearer ".concat(a)},i="&agentId="+t+"&pageId="+n,e.next=7,fetch("https://vishwacarrental.com:8080/agent/get_new_bookings?"+i,{headers:o});case 7:return s=e.sent,e.next=10,s.json();case 10:200==(c=e.sent).code?this.setState({item:c.data}):(console.log("errorr"),this.setState({error:"some internal error please try later"})),this.setState({isLoading:!1});case 13:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"payNow",value:function(){var e=Object(n.a)(Object(r.a)().mark((function e(t,a,o){var i,s;return Object(r.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:i=this.state.item.bookingId,s={key:"rzp_live_P6qbTUQVqidRo6",amount:100*t,currency:o,description:"Booking ID: "+i,image:"",order_id:a,handler:function(){var e=Object(n.a)(Object(r.a)().mark((function e(t){var a,n,o,s;return Object(r.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a={razorpayPaymentId:t.razorpay_payment_id,razorpayOrderId:t.razorpay_order_id,razorpaySignature:t.razorpay_signature,rawResponce:t},console.log("payment Responce data=="+JSON.stringify(a)+"==="+i),n=localStorage.getItem("token"),o={Authorization:"Bearer ".concat(n),"Content-Type":"application/json"},e.next=6,f.a.post("https://vishwacarrental.com:8080/agent/success",a,{headers:o});case 6:s=e.sent,console.log("result:"+s),window.location.href="/ThankYou/"+s.data.bookingId,alert(s.data.message);case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),prefill:{name:this.state.firstName+" "+this.state.lastName,email:this.state.email,contact:this.state.item.mobileNo},notes:{address:this.state.item.pickupCity},theme:{color:"#61dafb"}},new window.Razorpay(s).open();case 4:case"end":return e.stop()}}),e,this)})));return function(t,a,r){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this;return Object(y.jsxs)("div",{children:[Object(y.jsx)(b.default,{}),Object(y.jsx)("div",{children:Object(y.jsx)(m.a,{css:"\n        display: block;\n        margin: 0 auto;\n        border-color: red;\n        position: absolute;\n        z-index: 9;\n        margin: 0px auto;\n        left: 40%;\n        ",style:{borderColor:"red"},color:this.state.loadingColor,loading:this.state.isLoading,size:150,children:"  "})}),Object(y.jsx)("div",{children:Object(y.jsx)("section",{id:"pricing",className:"pricing",children:Object(y.jsx)("div",{className:"container","data-aos":"fade-up",style:{width:"95%!important"},children:Object(y.jsxs)("div",{className:"row",children:["active"==this.state.agentStatus?null:Object(y.jsx)("div",{className:"col-lg-12 col-md-12",children:"Your account is not approved yet please connect with admin to get approval"}),Object(y.jsx)("div",{className:"col-lg-12 col-md-12",children:Object(y.jsxs)(l.a,{children:[Object(y.jsx)(l.a.Title,{className:"bgColor",style:{fontSize:16,fontWeight:"bold",borderRadius:"5px 5px 0px 0px",padding:10,color:"white"},children:"New Booking "}),Object(y.jsx)(l.a.Body,{children:Object(y.jsx)("div",{style:{color:"red"},children:Object(y.jsxs)(u.a,{striped:!0,bordered:!0,hover:!0,responsive:!0,children:[Object(y.jsx)("thead",{children:Object(y.jsxs)("tr",{children:[Object(y.jsx)("th",{children:"BookingId"}),Object(y.jsx)("th",{children:"Name "}),Object(y.jsx)("th",{children:"Pickup"}),Object(y.jsx)("th",{children:"Destination"}),Object(y.jsx)("th",{children:"PickupDate"}),Object(y.jsx)("th",{children:"ReturnDate"}),Object(y.jsx)("th",{children:"Amount"}),Object(y.jsx)("th",{children:"Confirm"})]})}),Object(y.jsx)("tbody",{children:this.state.item.map((function(t,a){return Object(y.jsxs)("tr",{children:[Object(y.jsx)("td",{children:t.orderId}),Object(y.jsx)("td",{children:t.userName}),Object(y.jsx)("td",{children:t.pickup}),Object(y.jsx)("td",{children:t.destination}),Object(y.jsx)("td",{children:void 0!=t.pickupDate?t.pickupDate:null}),Object(y.jsx)("td",{children:void 0!=t.returnDate?t.returnDate:null}),Object(y.jsx)("td",{children:t.agentPrice}),Object(y.jsx)("td",{children:Object(y.jsx)(h.a.Group,{controlId:"formBasicEmail",style:{float:"right"},children:Object(y.jsxs)(p.a,{variant:"primary",type:"button",onClick:e.showPopup.bind(e,t),children:["Pay (",t.agentPrice*e.state.bookingCnfAmount/100,") to confirm"]})})})]},a+1)}))})]})})})]})})]})})})})]})}}]),a}(d.Component);t.default=Object(O.f)(v)}}]);
//# sourceMappingURL=54.5530ed90.chunk.js.map