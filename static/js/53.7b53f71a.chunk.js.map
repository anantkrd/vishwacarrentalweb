{"version":3,"sources":["component/Partner/CompletedBookingList.jsx","../node_modules/react-bootstrap/esm/Table.js"],"names":["CompletedBookingList","props","state","userId","item","error","isLoading","loadingColor","pageNo","payment_orderId","loadScript","src","Promise","resolve","script","document","createElement","onload","onerror","body","appendChild","prePayment","object","alert","advance","agentPrice","userAmount","finalAmount","paid","dataPay","amount","bookingId","orderId","agentId","bookingAmount","tripAmount","userPaid","axios","post","process","resultpay","console","log","setState","data","_id","currency","receipt","id","payNow","this","localStorage","getItem","getBooking","token","headers","urlData","fetch","response","json","dataRes","code","paymentid","options","key","description","image","order_id","handler","razorpayPaymentId","razorpay_payment_id","razorpayOrderId","razorpay_order_id","razorpaySignature","razorpay_signature","rawResponce","result","window","location","href","message","prefill","name","firstName","lastName","email","contact","mobileNo","notes","address","pickupCity","theme","color","Razorpay","open","css","style","borderColor","loading","size","className","width","Title","fontSize","fontWeight","borderRadius","padding","Body","striped","bordered","hover","responsive","map","i","variant","textAlign","to","pathname","userName","pickup","destination","undefined","pickupDate","returnDate","agentPaid","cashAmount","status","journyStatus","Component","withRouter","_excluded","Table","React","forwardRef","_ref","ref","bsPrefix","borderless","_objectWithoutPropertiesLoose","decoratedBsPrefix","useBootstrapPrefix","classes","classNames","table","_extends","responsiveClass"],"mappings":"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","file":"static/js/53.7b53f71a.chunk.js","sourcesContent":["import React, { Component } from 'react';\r\nimport Card from 'react-bootstrap/Card'\r\nimport { Button, Table } from 'react-bootstrap';\r\nimport Form from 'react-bootstrap/Form';\r\nimport Header from \"../Header\";\r\nimport Footer from \"../Footer\";\r\nimport { Link } from 'react-router-dom'\r\nimport { useHistory } from 'react-router-dom';\r\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\r\nimport ClipLoader from \"react-spinners/ClipLoader\";\r\nimport axios from \"axios\";\r\nimport { withRouter } from 'react-router-dom';\r\nclass CompletedBookingList extends Component {\r\n\r\n    state = { userId: '', item: [], error: '', isLoading: false, loadingColor: '#ffffff', pageNo: 0, payment_orderId: '' };\r\n    constructor(props) {\r\n        super(props);\r\n        //console.log(\"++pickup**********===\"+JSON.stringify(this.props));    \r\n    }\r\n\r\n    componentDidMount() {\r\n        this.setState({ isLoading: true });\r\n        let userId = localStorage.getItem(\"userId\");\r\n        this.setState({ userId: userId });\r\n\r\n        //this.setState({item:this.props.match.params.data});\r\n        this.getBooking(userId);\r\n    }\r\n\r\n    showPopup(object) {\r\n\r\n        this.prePayment(object);\r\n    }\r\n    async getBooking(userId) {\r\n\r\n\r\n        //const headers = { 'Content-Type': 'application/json' } \r\n        let token = localStorage.getItem(\"token\");\r\n        let pageNo = this.state.pageNo + 1;\r\n        const headers = { 'Authorization': `Bearer ${token}` };\r\n        let urlData = \"&userId=\" + userId + \"&pageId=\" + pageNo;\r\n        //const response = await fetch('http://localhost:3001/booking/getCabs?originObj='+originObj+'&destinationObj='+destinationObj, { headers });\r\n\r\n        const response = await fetch(process.env.REACT_APP_APIURL + 'agent/get_my_completed_bookings?' + urlData, { headers });\r\n        //console.log(\"+++response==\"+JSON.stringify(response))\r\n        const dataRes = await response.json();\r\n\r\n        if (dataRes.code == 200) {\r\n            this.setState({ item: dataRes.data });\r\n        } else {\r\n            console.log(\"errorr\")\r\n            this.setState({ error: 'some internal error please try later' })\r\n        }\r\n\r\n        this.setState({ isLoading: false });\r\n        //this.setState({cabsList:data.data});\r\n    }\r\n\r\n    loadScript = (src) => {\r\n        return new Promise((resolve) => {\r\n            const script = document.createElement(\"script\");\r\n            script.src = src;\r\n            script.onload = () => {\r\n                resolve(true);\r\n            };\r\n            script.onerror = () => {\r\n                resolve(false);\r\n            };\r\n            document.body.appendChild(script);\r\n        });\r\n    }\r\n    prePayment = async (object) => {\r\n\r\n        const res = await this.loadScript(\r\n            \"https://checkout.razorpay.com/v1/checkout.js\"\r\n        );\r\n\r\n        if (!res) {\r\n            alert(\"Razorpay SDK failed to load. Are you online?\");\r\n            return;\r\n        }\r\n        // creating a new order\r\n        const headers = { 'Content-Type': 'application/json' }\r\n        let UrlData = \"amount=\";\r\n        let advance = (object.agentPrice * 20) / 100;\r\n        let userAmount = object.finalAmount - object.paid;\r\n        const dataPay = {\r\n            amount: advance * 100,\r\n            bookingId: object.orderId,\r\n            agentId: this.state.userId,\r\n            bookingAmount: object.agentPrice,\r\n            tripAmount: object.finalAmount,\r\n            userPaid: object.paid,\r\n            userAmount: userAmount\r\n\r\n        };\r\n        const resultpay = await axios.post(process.env.REACT_APP_APIURL + \"agent/payment\", dataPay);\r\n\r\n        if (!resultpay) {\r\n            alert(\"Server error. Are you online?\");\r\n            return;\r\n        }\r\n\r\n        console.log(\"result==pay==\" + resultpay);\r\n        this.setState({ payment_orderId: resultpay.data.data._id, currency: resultpay.data.data.currency, receipt: resultpay.data.data.receipt });\r\n        //console.log(\"payment_orderId===\"+this.state.payment_orderId);\r\n        // Getting the order details back\r\n        const { amount, id, currency } = resultpay.data.data;\r\n        this.payNow(advance, resultpay.data.data._id, resultpay.data.data.currency)\r\n        return false;\r\n\r\n    }\r\n    async payNow(advance, paymentid, currency) {\r\n        const options = {\r\n            key: process.env.REACT_APP_PAYMENT_KEY,//\"rzp_test_8KHr7ine3uj7uk\", // Enter the Key ID generated from the Dashboard\r\n            amount: advance,\r\n            currency: currency,\r\n            description: \"Booking ID: \" + paymentid,\r\n            image: '',\r\n            order_id: paymentid,\r\n            handler: async function (response) {\r\n                const data = {\r\n                    razorpayPaymentId: response.razorpay_payment_id,\r\n                    razorpayOrderId: response.razorpay_order_id,\r\n                    razorpaySignature: response.razorpay_signature,\r\n                    rawResponce: response\r\n                };\r\n\r\n                const result = await axios.post(process.env.REACT_APP_APIURL + \"agent/success\", data);\r\n                window.location.href = \"/ThankYou/\" + this.state.item.bookingId;\r\n                alert(result.data.message);\r\n            },\r\n            prefill: {\r\n                name: this.state.firstName + \" \" + this.state.lastName,\r\n                email: this.state.email,\r\n                contact: this.state.item.mobileNo,\r\n            },\r\n            notes: {\r\n                address: this.state.item.pickupCity,\r\n            },\r\n            theme: {\r\n                color: \"#61dafb\",\r\n            },\r\n        };\r\n\r\n        const paymentObject = new window.Razorpay(options);\r\n        paymentObject.open();\r\n\r\n    }\r\n    render() {\r\n        const override = `\r\n        display: block;\r\n        margin: 0 auto;\r\n        border-color: red;\r\n        position: absolute;\r\n        z-index: 9;\r\n        margin: 0px auto;\r\n        left: 40%;\r\n        `;\r\n        return (\r\n\r\n            <div>\r\n                <Header />\r\n                <div>\r\n                    <ClipLoader css={override} style={{ borderColor: 'red' }} color={this.state.loadingColor} loading={this.state.isLoading} size={150} >  </ClipLoader>\r\n                </div>\r\n\r\n\r\n                <div>\r\n                    <section id=\"pricing\" className=\"pricing\">\r\n\r\n                        <div className=\"container\" data-aos=\"fade-up\" style={{ width: '95%!important' }}>\r\n\r\n                            <div className=\"row\">\r\n                                <div className=\"col-lg-12 col-md-12\">\r\n\r\n                                    <Card>\r\n                                        <Card.Title className=\"bgColor\" style={{ fontSize: 16, fontWeight: 'bold', borderRadius: \"5px 5px 0px 0px\", padding: 10, color: 'white' }}>My Completed Booking </Card.Title>\r\n                                        <Card.Body>\r\n                                            <div style={{ color: 'red' }}>\r\n                                                <Table striped bordered hover responsive>\r\n                                                    <thead>\r\n                                                        <tr>\r\n                                                            <th>BookingId</th>\r\n                                                            <th>Name </th>\r\n                                                            <th>Pickup</th>\r\n                                                            <th>Destination</th>\r\n                                                            <th>PickupDate</th>\r\n                                                            <th>ReturnDate</th>\r\n                                                            <th>Amount</th>\r\n                                                            <th>Booking Amount</th>\r\n                                                            <th>Payment From Passneger</th>\r\n                                                            <th>Status</th>\r\n                                                            <th>Journy</th>\r\n                                                        </tr>\r\n                                                    </thead>\r\n                                                    <tbody>\r\n                                                        {\r\n                                                            this.state.item.map((object, i) => {\r\n                                                                return <tr key={i+1}>\r\n                                                                    <td><Link variant=\"success\" style={{ padding: \"4px\", fontSize: 12, textAlign: \"center\" }} to={{ pathname: `/BookingDetails/${object.orderId}` }} >{object.orderId}</Link></td>\r\n                                                                    <td>{object.userName}({object.mobileNo})</td>\r\n                                                                    <td>{object.pickup}</td>\r\n                                                                    <td>{object.destination}</td>\r\n                                                                    <td>\r\n                                                                        {object.pickupDate !=undefined ? object.pickupDate : null\r\n                                                                        }\r\n                                                                    </td>\r\n                                                                    <td>\r\n                                                                        {object.returnDate !=undefined ? object.returnDate : null\r\n                                                                        }\r\n                                                                    </td>\r\n                                                                    <td>{object.agentPrice}</td>\r\n                                                                    <td>{object.agentPaid}</td>\r\n                                                                    <td>{object.cashAmount}</td>\r\n                                                                    <td>\r\n                                                                        {object.status}\r\n                                                                    </td><td>\r\n                                                                        {object.journyStatus}\r\n                                                                    </td>\r\n                                                                </tr>;\r\n                                                            })\r\n                                                        }\r\n\r\n                                                    </tbody>\r\n                                                </Table>\r\n                                            </div>\r\n\r\n                                        </Card.Body>\r\n                                    </Card>\r\n                                </div>\r\n\r\n                            </div>\r\n\r\n                        </div>\r\n\r\n                    </section>\r\n\r\n\r\n                </div>\r\n            </div>\r\n        );\r\n    }\r\n}\r\n\r\nexport default withRouter(CompletedBookingList);","import _extends from \"@babel/runtime/helpers/esm/extends\";\nimport _objectWithoutPropertiesLoose from \"@babel/runtime/helpers/esm/objectWithoutPropertiesLoose\";\nvar _excluded = [\"bsPrefix\", \"className\", \"striped\", \"bordered\", \"borderless\", \"hover\", \"size\", \"variant\", \"responsive\"];\nimport classNames from 'classnames';\nimport React from 'react';\nimport { useBootstrapPrefix } from './ThemeProvider';\nvar Table = /*#__PURE__*/React.forwardRef(function (_ref, ref) {\n  var bsPrefix = _ref.bsPrefix,\n      className = _ref.className,\n      striped = _ref.striped,\n      bordered = _ref.bordered,\n      borderless = _ref.borderless,\n      hover = _ref.hover,\n      size = _ref.size,\n      variant = _ref.variant,\n      responsive = _ref.responsive,\n      props = _objectWithoutPropertiesLoose(_ref, _excluded);\n\n  var decoratedBsPrefix = useBootstrapPrefix(bsPrefix, 'table');\n  var classes = classNames(className, decoratedBsPrefix, variant && decoratedBsPrefix + \"-\" + variant, size && decoratedBsPrefix + \"-\" + size, striped && decoratedBsPrefix + \"-striped\", bordered && decoratedBsPrefix + \"-bordered\", borderless && decoratedBsPrefix + \"-borderless\", hover && decoratedBsPrefix + \"-hover\");\n  var table = /*#__PURE__*/React.createElement(\"table\", _extends({}, props, {\n    className: classes,\n    ref: ref\n  }));\n\n  if (responsive) {\n    var responsiveClass = decoratedBsPrefix + \"-responsive\";\n\n    if (typeof responsive === 'string') {\n      responsiveClass = responsiveClass + \"-\" + responsive;\n    }\n\n    return /*#__PURE__*/React.createElement(\"div\", {\n      className: responsiveClass\n    }, table);\n  }\n\n  return table;\n});\nexport default Table;"],"sourceRoot":""}